{% extends 'Layouts/header.html.twig' %}

{% block body %}


	<div class="container-fluid">
		<h1 class="h3 text-gray-800">Ventas</h1>
		<p class="">Informacion de ventas</p>

		{% for message in app.session.flashbag.get('success') %}
			<div class="alert alert-success" role="alert">
				{{message}}
				<button type="button" class="close" data-dismiss="alert" aria-label="Close">
					<span aria-hidden="true">&times;</span>
				</button>
			</div>
		{% endfor %}
		{% for message in app.session.flashbag.get('error') %}
			<div class="alert alert-danger" role="alert">
				{{message}}
				<button type="button" class="close" data-dismiss="alert" aria-label="Close">
					<span aria-hidden="true">&times;</span>
				</button>
			</div>
		{% endfor %}


		<!-- DataTales Example -->
		<div class="card shadow mb-4">
			<div class="card-header py-3 d-flex">
				<h6 class="m-0 font-weight-bold text-primary col-md-2 col-lg-2 col-sm-12 col-xs-12 my-auto">Ventas</h6>
				<div class="col-md-10 col-lg-10 col-sm-12 col-xs-12 d-block">
					<a href='{{ path('show_form_sale') }}' class='btn btn-primary float-right'>Nuevo</a>
				</div>
			</div>
			<div class="card-body">
				<div class="table-responsive">
					<table class="table table-bordered" id="dataTable" width="100%" cellspacing="0">
						<thead>
							<tr>
                                <th>#</th>
								<th>Cliente</th>
								<th>Identificación</th>
								<th>Serie</th>
								<th>Secuencia</th>
								<th>Subtotal</th>
                                <th>Total</th>
                                <th>Ambiente</th>
                                <th>Estado</th>
								<th>Fecha emisión</th>
								<th>Fecha autorización</th>
								<th>Clave acceso</th>
								<th>Acciones</th>
							</tr>
						</thead>
						<tfoot>
							<tr>
								<th>#</th>
								<th>Cliente</th>
								<th>Identificación</th>
								<th>Serie</th>
								<th>Secuencia</th>
								<th>Subtotal</th>
                                <th>Total</th>
                                <th>Ambiente</th>
                                <th>Estado</th>
								<th>Fecha emisión</th>
								<th>Fecha autorización</th>
								<th>Clave acceso</th>
								<th>Acciones</th>
							</tr>
						</tfoot>
						<tbody>
							{% for row in data %}

								<tr>
									<td>{{row.id}}</td>
									<td>{{row.getCustomerId().company}}</td>
									<td>{{row.getCustomerId().getNumeroIdentificacion()}}</td>
									<td>{{row.getSerie()}}</td>
									<td>{{row.getSecuencia()}}</td>
									<td>${{row.getSubtotal()}}</td>
									<td>${{row.getTotal()}}</td>
									<td>
										{% if (row.getAmbiente() == '1') %}
											Pruebas
										{% elseif (row.getAmbiente() == '2') %}
											Producción
										{% endif %}
									</td>
                                    <td>
										{% if (row.getXmlEstado() == '0') %}
											Para enviar
										{% elseif (row.getXmlEstado() == '1') %}
											Pendiente
										{% elseif (row.getXmlEstado() == '2') %}
											Recibida
										{% elseif (row.getXmlEstado() == '3') %}
											Devuelta
										{% elseif (row.getXmlEstado() == '4') %}
											Autorizada
										{% else  %}
											No autorizada
										{% endif %}
									</td>
                                    <td>{{row.getCreatedAt()|date('Y-m-d')}}</td>
                                    <td>{{row.getFechaAutorizacion()|date('Y-m-d')}}</td>
									<td>{{row.getClaveAcceso()}}</td>
									<td>
										<div class='row text-center mx-auto justify-content-center'>
											<a href='{{ path('show_form_sale', {id: row.id})}}' class='btn btn-sm btn-success'>
												<i class="fa fa-edit" aria-hidden="true"></i>
											</a>
											<button type="button" class="btn btn-sm btn-danger ml-1" data-toggle="modal" data-target="#delete{{row.id}}">
												<i class="fa fa-trash" aria-hidden="true"></i>
											</button>
										</div>
									</td>
								</tr>
								<!-- Modal -->
								<div class="modal fade" id="delete{{row.id}}" tabindex="-1" role="dialog" aria-labelledby="delete" aria-hidden="true">
									<div class="modal-dialog" role="document">
										<div class="modal-content">
											<div class="modal-header">
												<h5 class="modal-title" id="exampleModalLabel">Esta seguro que desea eliminar?</h5>
												<button type="button" class="close" data-dismiss="modal" aria-label="Close">
													<span aria-hidden="true">&times;</span>
												</button>
											</div>
											<div class="modal-body">
												Está acción es permanente, está seguro que desea hacerlo?
											</div>
											<div class="modal-footer">
												<button type="button" class="btn btn-secondary" data-dismiss="modal">Cancelar</button>
												<a href='{{ path('delete_sale', {id: row.id })}}' type="button" class="btn btn-danger">Eliminar</a>
											</div>
										</div>
									</div>
								</div>
						{% endfor %}


					</tbody>
				</table>
			</div>
		</div>
	</div>
</div>

<script>

$(document).ready(function() {
  $("#example").dataTable({});
} );
	

</script>{% endblock %}
